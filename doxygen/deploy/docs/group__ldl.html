<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>LoraDeviceLib: LDL</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LoraDeviceLib</a>
   &#160;<span id="projectnumber">0.1.3+dd2db5b8955d67ec029d08340ba15147705c1857</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#groups">Modules</a>  </div>
  <div class="headertitle">
<div class="title">LDL</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for LDL:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__ldl.png" border="0" alt="" usemap="#group____ldl"/>
<map name="group____ldl" id="group____ldl">
<area shape="rect" id="node2" href="group__ldl__radio.html" title="Radio" alt="" coords="107,5,163,32"/>
<area shape="rect" id="node3" href="group__ldl__system.html" title="System interfaces. " alt="" coords="102,56,169,83"/>
<area shape="rect" id="node4" href="group__ldl__board.html" title="Board" alt="" coords="107,107,163,133"/>
<area shape="rect" id="node5" href="group__ldl__optional.html" title="Functions and macros which LDL depends on. " alt="" coords="100,157,171,184"/>
<area shape="rect" id="node6" href="group__ldl__mac.html" title="MAC" alt="" coords="109,208,161,235"/>
</map>
</td></tr></table></center>
</div>
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<p>Below is a basic example of how to use LDL to join and then send data: </p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;lora_board.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;lora_radio.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;lora_mac.h&quot;</span></div><div class="line"></div><div class="line"><span class="comment">/* implemented to suit target */</span></div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> radio_select(<span class="keywordtype">void</span> *receiver, <span class="keywordtype">bool</span> state);</div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> radio_reset(<span class="keywordtype">void</span> *receiver, <span class="keywordtype">bool</span> state);</div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> radio_write(<span class="keywordtype">void</span> *receiver, uint8_t value);</div><div class="line"><span class="keyword">extern</span> uint8_t radio_read(<span class="keywordtype">void</span> *receiver);</div><div class="line"></div><div class="line"><span class="comment">/* implemented to suit application (shown further down) */</span></div><div class="line"><span class="keywordtype">void</span> app_handler(<span class="keywordtype">void</span> *app, <span class="keyword">enum</span> <a class="code" href="group__ldl__mac.html#ga54ff159bcef75c8ac16b283521b2c057">lora_mac_response_type</a> type, <span class="keyword">const</span> <span class="keyword">union</span> <a class="code" href="group__ldl__mac.html#unionlora__mac__response__arg">lora_mac_response_arg</a> *arg);</div><div class="line"></div><div class="line"><span class="comment">/* state for the board connections, radio, and MAC layer */</span></div><div class="line"><span class="keyword">struct </span><a class="code" href="group__ldl__board.html#structlora__board">lora_board</a> board;</div><div class="line"><span class="keyword">struct </span><a class="code" href="group__ldl__radio.html#structlora__radio">lora_radio</a> radio;</div><div class="line"><span class="keyword">struct </span><a class="code" href="group__ldl__mac.html#structlora__mac">lora_mac</a> mac;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="comment">/* The radio driver uses a struct of function pointers to control </span></div><div class="line"><span class="comment">     * the hardware (i.e. the board connections).</span></div><div class="line"><span class="comment">     * </span></div><div class="line"><span class="comment">     * The board struct can be initialised directly or via the </span></div><div class="line"><span class="comment">     * LDL_Board_init() function.</span></div><div class="line"><span class="comment">     * </span></div><div class="line"><span class="comment">     * */</span></div><div class="line">    <a class="code" href="group__ldl__board.html#gaf434da0ec02b0e7344ab0e7933ae1e16">LDL_Board_init</a>(&amp;board,</div><div class="line">        NULL, </div><div class="line">        radio_select, </div><div class="line">        radio_reset,</div><div class="line">        radio_write,</div><div class="line">        radio_read</div><div class="line">    );</div><div class="line"></div><div class="line">    <span class="comment">/* To initialise the radio driver you need:</span></div><div class="line"><span class="comment">     * </span></div><div class="line"><span class="comment">     * - board connections</span></div><div class="line"><span class="comment">     * - radio type</span></div><div class="line"><span class="comment">     * - power amplifier configuration</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * */</span> </div><div class="line">    <a class="code" href="group__ldl__radio.html#gac4b8f66c49487fcc40560f9b617579a8">LDL_Radio_init</a>(&amp;radio, LORA_RADIO_SX1272, &amp;board);</div><div class="line">    <a class="code" href="group__ldl__radio.html#ga104ccfe61f5a4edaaeb35afdf1c52661">LDL_Radio_setPA</a>(&amp;radio, <a class="code" href="group__ldl__radio.html#gga6fb3491c94d5a6fa48da6fbd27ca6c24ac6c4153e7baf07cc9c5d366c2c6b11bb">LORA_RADIO_PA_RFO</a>);</div><div class="line"></div><div class="line">    <span class="comment">/* To initialise the mac layer you need:</span></div><div class="line"><span class="comment">     * </span></div><div class="line"><span class="comment">     * - initialised radio</span></div><div class="line"><span class="comment">     * - region code</span></div><div class="line"><span class="comment">     * - application callback</span></div><div class="line"><span class="comment">     * </span></div><div class="line"><span class="comment">     * */</span></div><div class="line">    <a class="code" href="group__ldl__mac.html#gadaccbebc6539ccb3f979601c90775865">LDL_MAC_init</a>(&amp;mac, NULL, EU_863_870, &amp;radio, app_handler);</div><div class="line"></div><div class="line">    <span class="comment">/* - join if not joined</span></div><div class="line"><span class="comment">     * - send &#39;hello world&#39; if joined</span></div><div class="line"><span class="comment">     * - do nothing if not ready (e.g. busy joining, busy sending, duty cycle limits)</span></div><div class="line"><span class="comment">     * - run everything by polling LDL_MAC_process()</span></div><div class="line"><span class="comment">     * </span></div><div class="line"><span class="comment">     * */</span></div><div class="line">    <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div><div class="line">        </div><div class="line">        <span class="keywordflow">if</span>(<a class="code" href="group__ldl__mac.html#ga06572d6ffb98c0f08285b0b6d8eb7799">LDL_MAC_ready</a>(&amp;mac)){</div><div class="line">            </div><div class="line">            <span class="keywordflow">if</span>(<a class="code" href="group__ldl__mac.html#ga05c23507476c69f3ac888114b3d63b7f">LDL_MAC_joined</a>(&amp;mac)){</div><div class="line">                </div><div class="line">                <span class="keyword">const</span> <span class="keywordtype">char</span> msg[] = <span class="stringliteral">&quot;hello world&quot;</span>;                </div><div class="line">                                </div><div class="line">                (void)<a class="code" href="group__ldl__mac.html#ga8922e7f414d77d97979a859eacdf904b">LDL_MAC_unconfirmedData</a>(&amp;mac, 1, msg, <span class="keyword">sizeof</span>(msg));</div><div class="line">            }</div><div class="line">            <span class="keywordflow">else</span>{</div><div class="line">                </div><div class="line">                (void)<a class="code" href="group__ldl__mac.html#ga68116556aef51be98a4984cd8ac71340">LDL_MAC_otaa</a>(&amp;mac);</div><div class="line">            }            </div><div class="line">        }</div><div class="line">        </div><div class="line">        <a class="code" href="group__ldl__mac.html#ga12683623ce207d5a43bd7c54e8b06e4e">LDL_MAC_process</a>(&amp;mac);        </div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">/* This will be called from within LDL_MAC_process() to pass events back to</span></div><div class="line"><span class="comment"> * the application.</span></div><div class="line"><span class="comment"> * </span></div><div class="line"><span class="comment"> * Your application can handle or ignore the events depending on</span></div><div class="line"><span class="comment"> * your requirements.</span></div><div class="line"><span class="comment"> * </span></div><div class="line"><span class="comment"> * */</span></div><div class="line"><span class="keywordtype">void</span> app_handler(<span class="keywordtype">void</span> *app, <span class="keyword">enum</span> <a class="code" href="group__ldl__mac.html#ga54ff159bcef75c8ac16b283521b2c057">lora_mac_response_type</a> type, <span class="keyword">const</span> <span class="keyword">union</span> <a class="code" href="group__ldl__mac.html#unionlora__mac__response__arg">lora_mac_response_arg</a> *arg)</div><div class="line">{</div><div class="line">    <span class="keywordflow">switch</span>(type){</div><div class="line">        </div><div class="line">    <span class="comment">/* LoRaWAN needs a little bit of random for correct operation. </span></div><div class="line"><span class="comment">     * </span></div><div class="line"><span class="comment">     * Targets that have no better source of entropy will use this</span></div><div class="line"><span class="comment">     * event to seed the stdlib random generator.</span></div><div class="line"><span class="comment">     * </span></div><div class="line"><span class="comment">     * */</span></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057a02c2195a62d9a6f39c60b3fd678c4aef">LORA_MAC_STARTUP</a>:</div><div class="line">    </div><div class="line">        srand(arg-&gt;<a class="code" href="group__ldl__mac.html#a62db6272ec57e10d55072cd054fba054">startup</a>.<a class="code" href="group__ldl__mac.html#a7d701306c0b8461c32dceb81b9b52981">entropy</a>);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="comment">/* Downstream messages are events so this is where you get</span></div><div class="line"><span class="comment">     * them.</span></div><div class="line"><span class="comment">     * </span></div><div class="line"><span class="comment">     * */</span></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057a03346e67a7df3df8c93dc8113f693026">LORA_MAC_DOWNSTREAM</a>:    </div><div class="line">        <span class="comment">/* do something */</span></div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">        </div><div class="line">    <span class="comment">/* Ignore all other events */</span></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057ae42e3891814623729b0a9c08903af941">LORA_MAC_CHIP_ERROR</a>:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057ab8959a8177db6c1ccf5af2c3cb75fb1a">LORA_MAC_RESET</a>:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057a1737d280074426a1a805cf4a4a5bf748">LORA_MAC_JOIN_COMPLETE</a>:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057a8f7f166399c8762a66ad130ff795ff40">LORA_MAC_JOIN_TIMEOUT</a>:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057a208a7aead8007aeb09d22258890fd66f">LORA_MAC_DATA_COMPLETE</a>:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057afadc0118c108499dd3eaeec6c61e30cb">LORA_MAC_DATA_TIMEOUT</a>:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057a724245cd9987876b079ceb402d7c9360">LORA_MAC_DATA_NAK</a>:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057a6911ab588ea69777cdeb17e57414d5fb">LORA_MAC_RX</a>:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057aae3e696d2f6769e439f0fdf991df401e">LORA_MAC_LINK_STATUS</a>:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057aca3985f2c1364133f7a8f294a90947e6">LORA_MAC_RX1_SLOT</a>:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057a37de152a1311db6e4614dbd1a0ec613d">LORA_MAC_RX2_SLOT</a>:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057a5b25434385cc30f2d929972be4321fdd">LORA_MAC_TX_COMPLETE</a>:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__ldl__mac.html#gga54ff159bcef75c8ac16b283521b2c057aa89117051b8e761ef2fe5ace4ed96b08">LORA_MAC_TX_BEGIN</a>:</div><div class="line">    <span class="keywordflow">default</span>:</div><div class="line">        <span class="keywordflow">break</span>;    </div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> <table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__ldl__board"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ldl__board.html">Board</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__ldl__mac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ldl__mac.html">MAC</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__ldl__radio"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ldl__radio.html">Radio</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__ldl__optional"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ldl__optional.html">Optional</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__ldl__system"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ldl__system.html">System</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"></address>
</body>
</html>
